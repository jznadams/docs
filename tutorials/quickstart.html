<h1 id="respoke-quickstart">Respoke Quickstart</h1>
<p>Welcome to Respoke. This quick guide should help you build a <strong>messaging and audio calling app</strong> in about 10 minutes. This tutorial uses development mode for ease of development, but all apps should be converted to using <a href="/tutorials/brokered-auth.html">brokered authentication</a> before being published.</p>
<h3 id="step-1-create-a-respoke-account">Step 1: Create a Respoke Account</h3>
<p>Go to the <a href="https://www.respoke.io">Respoke.io website</a> and sign up. It’s free.</p>
<p>When your account is confirmed, visit the <a href="https://portal.respoke.io">Dev Console</a>.</p>
<h3 id="step-2-create-an-application">Step 2: Create An Application</h3>
<p>In the <a href="https://portal.respoke.io">Developer Console</a> go to the “Apps” page and
click on “New App”. After you have named and created the app, click on the app
tile to edit it.</p>
<p>Make sure the <strong>Development Mode</strong> option is enabled (dev mode is the default).</p>
<p>Find the <strong>App ID</strong> and copy it (not the App Secret).</p>
<p><em>Example</em></p>
<pre><code>3a56901d-78ca-4436-b696-4a7a66cdc1ac
</code></pre><h3 id="step-3-html-scaffold">Step 3: HTML Scaffold</h3>
<p>You can either use a real web server or something like <a href="http://jsfiddle.net">JSFiddle</a>. This is <strong>strictly client-side</strong> stuff (HTML, CSS and JavaScript) so you won’t need any server-side tech.</p>
<p>We’re using jQuery here, but you’re welcome to use whatever library you prefer. Respoke has no dependencies.</p>
<pre><code>&lt;html&gt;
    &lt;head&gt;
        &lt;!-- Respoke client library --&gt;
        &lt;script src=&quot;https://cdn.respoke.io/respoke.min.js&quot;&gt;&lt;/script&gt;

        &lt;!-- jQuery, for this example --&gt;
        &lt;script src=&quot;http://code.jquery.com/jquery-1.11.0.min.js&quot;&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h3 id=&quot;status&quot;&gt;Not Connected&lt;/h3&gt;
        &lt;div id=&quot;login&quot;&gt;
            User Name:
            &lt;input id=&quot;endpoint&quot; type=&quot;text&quot; /&gt;
            &lt;input id=&quot;doLogin&quot; type=&quot;button&quot; value=&quot;Connect&quot; /&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p><em>Pro Tip: If you’re using JSFiddle, only add the stuff inside the &lt;body&gt; tag to the HTML panel, add jQuery using the Frameworks &amp; Extensions box, and drop the Respoke library URL from the second &lt;script&gt; tag to the External Resources list.</em></p>
<p>Add some optional CSS:</p>
<pre><code>body {
    font-family: Arial, Helvetica;
    margin-left: 25px;
}
</code></pre><h3 id="step-4-connecting-to-respoke">Step 4: Connecting To Respoke</h3>
<p>The first thing your client will need to do is connect to Respoke. All that takes is a ‘client’ object and an access token.</p>
<pre><code>// here&#39;s the App ID value from the portal:
var appid = &quot;DD90A374-0C06-456F-9D4F-E8038E6523D2&quot;;

// create a client object using the App ID value from Step 2
var client = respoke.createClient({
    appId: appid,
    developmentMode: true
});

// listen for the &#39;connect&#39; event
client.listen(&#39;connect&#39;, function () {
    $(&quot;#status&quot;).html(&quot;Connected to Respoke!&quot;);
});

// now connect when the user clicks the &#39;Connect&#39; button
$(&quot;#doLogin&quot;).click(function () {
    var endpoint = $(&quot;#endpoint&quot;).val();
    client.connect({
        endpointId: endpoint // your username is the endpoint
    });
});
</code></pre><p>Once you have that in place, run it. You should see the page load with a “Not Connected” status.</p>
<p>Enter a name - whatever you want - in the User Name box and click the ‘Connect’ button. The status box should update to read “Connected To Respoke!”.</p>
<h3 id="step-5-sending-messages">Step 5: Sending Messages</h3>
<p>Ok, so you’re connected. Time to kick the tires by sending a message.</p>
<p>Add a bit more to your HTML scaffold:</p>
<pre><code>&lt;body&gt;
    &lt;h3 id=&quot;status&quot;&gt;Not Connected&lt;/h3&gt;
    &lt;div id=&quot;login&quot;&gt;
        User Name:
        &lt;input id=&quot;endpoint&quot; type=&quot;text&quot; /&gt;
        &lt;input id=&quot;doLogin&quot; type=&quot;button&quot; value=&quot;Connect&quot; /&gt;
    &lt;/div&gt;
    &lt;div id=&quot;messaging&quot;&gt;
        &lt;ul id=&quot;messages&quot;&gt;&lt;/ul&gt;&lt;br /&gt;
        Send To:
        &lt;input id=&quot;remoteId&quot; type=&quot;text&quot; /&gt;&lt;br /&gt;
        &lt;textarea id=&quot;textToSend&quot; rows=&quot;2&quot;&gt;&lt;/textarea&gt;&lt;br /&gt;
        &lt;input id=&#39;sendMessage&#39; type=&#39;button&#39; value=&#39;Send Message&#39; /&gt;
    &lt;/div&gt;
&lt;/body&gt;
</code></pre><p>Some additional CSS will help the layout.</p>
<pre><code>#messages {
    height: 400px;
    width: 400px;
    border: 1px solid #c7c7c7;
    overflow-x: hidden;
    overflow-y: auto;
    padding: 5px;
}

#textToSend {
    width: 400px;
    padding: 5px;
}
</code></pre><p>To receive messages, add a listener to the client that formats the message and adds it to the screen.</p>
<pre><code>// listen for incoming messages
client.listen(&#39;message&#39;, function(evt) {
    $(&quot;#messages&quot;).append(
        &quot;&lt;li&gt;&quot; + evt.message.message + &quot;&lt;/li&gt;&quot;
    );
});
</code></pre><p>To send a message, you just need to know the ID of the person (or device) you want to message. Use the ID to create an ‘endpoint’ object, and use the <a href="/js-library/endpoint.js.html#sendMessage">endpoint object’s sendMessage()</a> method:</p>
<pre><code>$(&quot;#sendMessage&quot;).click(function (){

    // get the recipient name
    var remote = $(&quot;#remoteId&quot;).val();

    // make an endpoint for that recipient
    var endpoint = client.getEndpoint({ id: remote });

    // grab the text to send
    var messageText = $(&quot;#textToSend&quot;).val();

    // send it
    endpoint.sendMessage({ message : messageText });

    // show yourself the message
    $(&quot;#messages&quot;).append(
        &quot;&lt;li&gt;&quot; + messageText + &quot;&lt;/li&gt;&quot;
    );

    // clear the text you just sent
    $(&quot;#textToSend&quot;).val(&#39;&#39;);
});
</code></pre><p><br /></p>
<h4 id="-test-messaging-"><strong>Test messaging</strong></h4>
<p>Open the page on two different computers, or using a private browsing session in a second window on the same computer.</p>
<p>Log in using a different name on each.</p>
<p>Enter the name of the <em>other</em> login into the “Send To” box.</p>
<p>Add a message and hit the “Send Message” button. The message should appear for both users.</p>
<h3 id="step-6-make-an-audio-call">Step 6: Make An Audio Call</h3>
<p>Now that you can send messages between clients, it doesn’t take much to get audio calls working.</p>
<p>Update the HTML with some buttons to attach the call handlers to.</p>
<pre><code>&lt;div id=&quot;messaging&quot;&gt;
    &lt;ul id=&quot;messages&quot;&gt;&lt;/ul&gt;&lt;br /&gt;
    Send To:
    &lt;input id=&quot;remoteId&quot; type=&quot;text&quot; /&gt;&lt;br /&gt;
    &lt;textarea id=&quot;textToSend&quot; rows=&quot;2&quot;&gt;&lt;/textarea&gt;&lt;br /&gt;
    &lt;input id=&#39;sendMessage&#39; type=&#39;button&#39; value=&#39;Send Message&#39; /&gt;
    &lt;input id=&#39;makeCall&#39; type=&#39;button&#39; value=&#39;Audio Call&#39; /&gt;
    &lt;input id=&#39;endCall&#39; type=&#39;button&#39; value=&#39;Hang Up&#39; /&gt;
&lt;/div&gt;
</code></pre><p>At the top of your JS, add a variable to track the active call.</p>
<pre><code>var call = null;
</code></pre><p>The <strong>call</strong> event handler captures the incoming call and automatically answers it.</p>
<pre><code>// listen for, and answer, incoming calls
client.listen(&#39;call&#39;, function(evt) {
     call = evt.call;
     if (call.caller !== true) {
         call.answer({constraints: {audio: true, video: false}});
         call.listen(&#39;hangup&#39;, function () {
             call = null;
         });
     }
});
</code></pre><p>Now wire up the “Audio Call” button to a function that places a new audio call and the “Hangup” button to a function that disconnects an active call:</p>
<pre><code>// Call somebody
$(&quot;#makeCall&quot;).click(function () {
    var endpoint = client.getEndpoint({ id: $(&quot;#remoteId&quot;).val() });
    call = endpoint.startAudioCall();
    call.listen(&#39;hangup&#39;, function () {
        call = null;
    });
});

// Hang up on them
$(&quot;#endCall&quot;).click(function () {
    if (call) {
        call.hangup();
        call = null;
    }
});
</code></pre><p><br /></p>
<h4 id="-test-audio-calls-"><strong>Test audio calls</strong></h4>
<p>Follow the same steps as <em>Test messaging</em>, but click the “Audio Call” button.</p>
<p>The browser will prompt you to allow the call. Both parties must accept before the call will go through. <em>This is a WebRTC requirement for security reasons. If you host your application on a secure server (HTTPS), the user will be allowed to grant the “Allow” permission on an ongoing basis.</em></p>
<h3 id="the-whole-enchilada">The Whole Enchilada</h3>
<p>So there you have it. IM and voice calling in a few lines of code.</p>
<p><a href="http://jsbin.com/jipeg">Try it live &raquo;</a></p>
<h3 id="html">HTML</h3>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;script type=&#39;text/javascript&#39; src=&#39;https://cdn.respoke.io/respoke.min.js&#39;&gt;&lt;/script&gt;
  &lt;script type=&#39;text/javascript&#39; src=&#39;http://code.jquery.com/jquery-2.1.0.min.js&#39;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h3 id=&quot;status&quot;&gt;Not Connected&lt;/h3&gt;
    &lt;div id=&quot;login&quot;&gt;
        User Name:
        &lt;input id=&quot;endpoint&quot; type=&quot;text&quot; /&gt;
        &lt;input id=&quot;doLogin&quot; type=&quot;button&quot; value=&quot;Connect&quot; /&gt;
    &lt;/div&gt;
    &lt;div id=&quot;messaging&quot;&gt;
        &lt;ul id=&quot;messages&quot;&gt;&lt;/ul&gt;&lt;br /&gt;
        Send To:
        &lt;input id=&quot;remoteId&quot; type=&quot;text&quot; /&gt;&lt;br /&gt;
        &lt;textarea id=&quot;textToSend&quot; rows=&quot;2&quot;&gt;&lt;/textarea&gt;&lt;br /&gt;
        &lt;input id=&#39;sendMessage&#39; type=&#39;button&#39; value=&#39;Send Message&#39; /&gt;
        &lt;input id=&#39;makeCall&#39; type=&#39;button&#39; value=&#39;Audio Call&#39; /&gt;
        &lt;input id=&#39;endCall&#39; type=&#39;button&#39; value=&#39;Hang Up&#39; /&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre><h3 id="css">CSS</h3>
<pre><code>body {
      font-family: Arial, Helvetica;
      margin-left: 25px;
}

#messages {
    height: 200px;
    width: 400px;
    border: 1px solid #c7c7c7;
    overflow-x: hidden;
    overflow-y: auto;
    padding: 5px;
}

#textToSend {
    width: 400px;
    padding: 5px;
}
</code></pre><h3 id="javascript">JavaScript</h3>
<pre><code>var appid = &quot;DD90A374-0C06-456F-9D4F-E8038E6523D2&quot;;
var call = null;

// create a client object using the App ID value from Step 2
var client = respoke.createClient({
      appId: appid,
      developmentMode: true
});

// listen for the &#39;connect&#39; event
client.listen(&#39;connect&#39;, function () {
    $(&quot;#status&quot;).html(&quot;Connected to Respoke!&quot;);
});

// listen for incoming messages
client.listen(&#39;message&#39;, function(evt) {
    $(&quot;#messages&quot;).append(&quot;&lt;li&gt;&quot; + evt.message.message + &quot;&lt;/li&gt;&quot;);
});

// listen for and answer incoming calls
client.listen(&#39;call&#39;, function(evt) {
    call = evt.call;
    if (call.caller !== true) {
        call.answer({constraints: {audio: true, video: false}});
        call.listen(&#39;hangup&#39;, function () {
             call = null;
        });
    }
});

// now connect when the user clicks the &#39;Connect&#39; button
$(&quot;#doLogin&quot;).click(function () {
    var endpoint =  $(&quot;#endpoint&quot;).val();
    client.connect({
        endpointId: endpoint
    });
});

// send a message to the far-end party
$(&quot;#sendMessage&quot;).click(function (){

    // get the recipient name
    var remote = $(&quot;#remoteId&quot;).val();

    // make an endpoint for that recipient
    var endpoint = client.getEndpoint({ id: remote});

    // grab the text to send
    var messageText = $(&quot;#textToSend&quot;).val();

    // send it
    endpoint.sendMessage({ message : messageText });
});

// Create a call
$(&quot;#makeCall&quot;).click(function () {
    var endpoint = client.getEndpoint({ id: $(&quot;#remoteId&quot;).val()});
    call = endpoint.startAudioCall();
});

// Hang up the call
$(&quot;#endCall&quot;).click(function () {
    if (call) {
        call.hangup();
        call = null;
    }
});
</code></pre><p><br /></p>
<p><a href="/tutorials/video-chat.html">Now you’re ready for video!</a></p>
